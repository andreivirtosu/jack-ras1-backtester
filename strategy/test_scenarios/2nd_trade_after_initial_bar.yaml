scenarios:
  - desc: "2nd trade after initial bar  => sell"
    config:
      symbol: "IBM"
      trading_mode:
        type: "Daily"
        value: 1
      dollar_amount: 1000
      base_bar_opp: false
      thresholds:
        base_bar_pct: 10.0
        base_bar_end_pct: 1.0
        non_base_bar_end_pct: 1.0
        non_base_bar_min_pct: 10.0
    bars:
      - { o: 110.0, h: 111.0, l: 90.00, c: 99.00, vol: 100000, is_base_bar: false }
      - { o: 111.0, h: 120.0, l: 90.00, c: 100.0, vol: 100000, is_base_bar: true }
      - { o: 112.0, h: 130.0, l: 92.00, c: 98.00, vol: 100000, is_base_bar: false }
      - { o: 113.0, h: 140.0, l: 88.00, c: 124.0, vol: 100000, is_base_bar: false }
    expected_signals:
      - signal_type: "Buy"
        signal_trigger_price: 112.0
        size: 8
        reason: "first trade"
      - signal_type: "Sell"
        signal_trigger_price: 88.2
        size: 19
        reason: "reverse [after initial-bar]"

  - desc: "2nd trade after initial bar  => NO sell"
    config:
      symbol: "IBM"
      trading_mode:
        type: "Daily"
        value: 1
      dollar_amount: 1000
      base_bar_opp: false
      thresholds:
        base_bar_pct: 10.0
        base_bar_end_pct: 1.0
        non_base_bar_end_pct: 1.0
        non_base_bar_min_pct: 10.0
    bars:
      - { o: 110.0, h: 111.0, l: 100.0, c: 109.0, vol: 100000, is_base_bar: false }
      - { o: 111.0, h: 120.0, l: 110.0, c: 110.0, vol: 100000, is_base_bar: true }
      - { o: 112.0, h: 130.0, l: 100.0, c: 110.0, vol: 100000, is_base_bar: false }
      - { o: 113.0, h: 140.0, l: 100.0, c: 124.0, vol: 100000, is_base_bar: false }
    expected_signals:
      - signal_type: "Buy"
        signal_trigger_price: 112.0
        size: 8
        reason: "first trade"

  - desc: "2nd trade after initial bar  => buy"
    config:
      symbol: "IBM"
      trading_mode:
        type: "Daily"
        value: 1
      dollar_amount: 1000
      base_bar_opp: false
      thresholds:
        base_bar_pct: 10.0
        base_bar_end_pct: 1.0
        non_base_bar_end_pct: 1.0
        non_base_bar_min_pct: 10.0
    bars:
      - { o: 130.0, h: 140.0, l: 125.0, c: 135.0, vol: 100000, is_base_bar: false }
      - { o: 130.0, h: 110.0, l: 120.0, c: 100.0, vol: 100000, is_base_bar: true }
      - { o: 124.0, h: 110.0, l: 120.0, c: 111.0, vol: 100000, is_base_bar: false }
      - { o: 124.0, h: 130.0, l: 120.0, c: 120.0, vol: 100000, is_base_bar: false }
    expected_signals:
      - signal_type: "Sell"
        signal_trigger_price: 124.0
        size: 8
        reason: "first trade"
      - signal_type: "Buy"
        signal_trigger_price: 122.1
        size: 16
        reason: "reverse [after initial-bar]"

  - desc: "2nd trade after initial bar  => NO buy"
    config:
      symbol: "IBM"
      trading_mode:
        type: "Daily"
        value: 1
      dollar_amount: 1000
      base_bar_opp: false
      thresholds:
        base_bar_pct: 10.0
        base_bar_end_pct: 1.0
        non_base_bar_end_pct: 1.0
        non_base_bar_min_pct: 10.0
    bars:
      - { o: 130.0, h: 140.0, l: 125.0, c: 135.0, vol: 100000, is_base_bar: false }
      - { o: 130.0, h: 135.0, l: 120.0, c: 120.0, vol: 100000, is_base_bar: true }
      - { o: 124.0, h: 136.0, l: 120.0, c: 120.0, vol: 100000, is_base_bar: false }
      - { o: 124.0, h: 137.0, l: 120.0, c: 120.0, vol: 100000, is_base_bar: false }
    expected_signals:
      - signal_type: "Sell"
        signal_trigger_price: 124.0
        size: 8
        reason: "first trade"
